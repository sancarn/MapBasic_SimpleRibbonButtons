'#######################################################################################################################
'#                                                                                                                     #
'#                                                    RIBBONLib.DEF                                                    #
'#                                                                                                                     #
'#######################################################################################################################
'*************************************************************************************************
'**	H I S T O R Y
'*************************************************************************************************
'	04-09-2014 14:02:01:	- Renamed RBNClearCustomButtons to RBNClearCustomRibbonElements
'						- Fixed these functions to work with controls of type IRibbonButtonControl as well as IRibbonToolButtonControl:
'							- RBNSetControlIcons
'							- RBNSetControlCustomMBXHandler
'	13-09-2014 13:40:41		- RBNAddTab now takes a KeyTip in stead of a ToolTip string
'						- RBNAddTab now returns an integer pointing at the modular index of the tab
'						- RBNAddGroup now returns an integer pointing at the modular index of the group
'						- These functions now also take a KeyTip
'							- RBNAddControl(...) As Integer
'							- RBNInsertControl(..) As Integer
'							- RBNInsertControlAfter(..) As Integer
'							- RBNInsertControlBefore(..) As Integer
'							- RBNAddButton(..) As Integer
'							- RBNInsertButton() As Integer
'							- RBNInsertButtonAfter(..) As Integer
'							- RBNInsertButtonBefore(..) As Integer
'							- RBNAddButtonContext(...)
'						- Added these procedures:
'							- RBNSetTabToolTipName(...)
'							- RBNSetTabToolTipIdx(...)
'							- RBNSetGroupToolTipName(...)
'							- RBNSetGroupToolTipIdx(...)
'	14-09-2014 13:05:02		- Added the procedures:
'							- RBNEnableControl(...)
'							- RBNEnableControlsName(...)
'							- RBNEnableControlName(...)
'							- RBNEnableControlIdx(...)
'						- and these private functions
'							- RBNGetElementIndex(...) As Integer
'							- RBNGetElementIndexOffset(...) As Integer
'	23-09-2014 20:42:00		- RBNClearCustomRibbonElements:
'							- If the rbnControlsColl isn't empty, the Group isn't removed
'							- If the rbnGroupsColl isn't empty, the Tab isn't removed
'						- Added:
'							- RBNEventSubscribe() As Logical
'							- RBNEventUnsubscribe() As Logical
'							- RBNEventUnsubscribeAll() As Logical
'							- RBNEndHandler
'							- RBNGetTableEventArgsTableAlias(...) As String
'	24-11-2014 13:37:40		- RBNLoop:
'							Now also loops thru the groups and controls of SplitButtons and Galleries
'						- Added:
'							- RBNGetGalleryGroup(...) As Logical
'							- RBNGetGalleryGroupIndex(...) As Integer
'							- RBNGalleryGroupExists(...) As Integer
'							- RBNGetSplitButtonGroup(...) As Logical
'							- RBNGetSplitButtonGroupIndex(...) As Integer
'							- RBNSplitButtonGroupExists(...) As Integer
'							- RBNGetControl(...) As Integer
'							- RBNRemoveTab(...) As Integer
'							- RBNRemoveGroup(...) As Integer
'							- RBNRemoveControl(...) As Integer
'							- RBNRemoveSplitButtonControl(...) As Logical
'							- RBNNumGroupsOnTab(...) As Integer
'							- RBNNumControlsOnGroup(...) As Integer
'	27-11-2014 19:05:14		- Added:
'							- RBNShowNotification(...)
'							- RBNSetControlDefaultLeftMargin(...)
'							- RBNSetControlLeftMargin(...)
'							- RBNSetControlLeftMarginIdx(...)
'	01-12-2014 09:07:13		- Added:
'							- RBNAddToolContextMenuItem(...) As Integer
'							- RBNRemoveToolContextMenuItem(...) As Integer
'							- RBNGetControlIndexFromCollection(...) As Integer
'							- RBNSetControlKeyGesture(...)
'							- RBNSetControlKeyGestureIdx(...)
'							- RBNAddButtonMapMiniToolbar(...)
'							- RBNRemoveControlMapMiniToolbar(...)
'						- Fixed:
'							- Return type of RBNRemoveSplitButtonControl changed to Integer
'							- RBNSetControlToolTip: Now supports all possible control types
'							- RBNSetControlIcons: Now supports all possible control types
'							- RBNSetControlLeftMargin: Now supports all possible control types
'							- RBNSetControlCustomMBXHandler: Now supports all possible control types
'							- RBNSetControlIconsIdx: Now takes nSize as Integer in stead of bIsLarge as Float
'							- RBNSetControlIcons: Now takes nSize as Integer in stead of bIsLarge as Float
'							- RBNSetControlToolTipIdx: The order of sText and sDescription have been changed
'							- RBNSetControlToolTip: The order of sText and sDescription have been changed
'							- RBNClearCustomRibbonElements: now also supports MapMiniToolbar and ToolContextMenu
'	02-12-2014 21:36:24		- Fixed:
'							- RBNSetControlMICursorIdx / RBNSetControlMICursor: Now also supports cursors in files, even 32 bit
'						- Renames:
'							- RBNGetControlTypeName -> RBNControlGetTypeName
'							- RBNSetTabToolTipName -> RBNTabSetToolTipName
'							- RBNSetTabToolTipIdx -> RBNTabSetToolTipIdx
'							- RBNNumGroupsOnTab -> RBNTabNumGroups
'							- RBNAddGroup -> RBNTabAddGroup
'							- RBNRemoveGroup -> RBNTabGroupRemove
'							- RBNSetGroupToolTipName -> RBNGroupSetToolTipName
'							- RBNSetGroupToolTipIdx -> RBNGroupSetToolTipIdx
'							- RBNNumControlsOnGroup -> RBNGroupNumControls
'							- RBNAddControl -> RBNGroupAddControl
'							- RBNRemoveControl -> RBNGroupRemoveControl
'							- RBNControlInsert -> RBNGroupInsertControl
'							- RBNInsertControlAfter -> RBNGroupInsertControlAfter
'							- RBNInsertControlBefore -> RBNGroupInsertControlBefore
'							- RBNAddSplitButtonControl -> RBNSplitButtonGroupAddControl
'							- RBNRemoveSplitButtonControl -> RBNSplitButtonGroupRemoveControl
'							- RBNAddButton -> RBNGroupAddButton
'							- RBNInsertButton -> RBNGroupInsertButton
'							- RBNInsertButtonAfter -> RBNGroupInsertButtonAfter
'							- RBNInsertButtonBefore -> RBNGroupInsertButtonBefore
'							- RBNAddButtonContext -> RBNContextGroupAddButton
'							- RBNAddToolContextMenuItem -> RBNToolContextMenuAddMenuItem
'							- RBNremoveToolContextMenuItem -> RBNToolContextMenuRemoveMenuItem
'							- RBNAddButtonMapMiniToolbar -> RBNMapMiniToolbarAddButton
'							- RBNRemoveControlMapMiniToolbar -> RBNMapMiniToolbarRemoveControl
'							- RBNSetControlToolTip -> RBNControlSetToolTip
'							- RBNSetControlToolTipIdx -> RBNControlSetToolTipIdx
'							- RBNSetControlKeyGesture -> RBNControlSetKeyGesture
'							- RBNSetControlKeyGestureIdx -> RBNControlSetKeyGestureIdx
'							- RBNSetControlIcons -> RBNControlSetIcons
'							- RBNSetControlIconsIdx -> RBNControlSetIconsIdx
'							- RBNSetControlDefaultLeftMargin -> RBNControlSetDefaultLeftMargin
'							- RBNSetControlLeftMargin -> RBNControlSetLeftMargin
'							- RBNSetControlLeftMarginIdx -> RBNControlSetLeftMarginIdx
'							- RBNSetControlCustomMBXHandler -> RBNControlSetCustomMBXHandler
'							- RBNSetControlCustomMBXHandlerIdx -> RBNControlSetCustomMBXHandlerIdx
'							- RBNSetControlDrawMode -> RBNControlSetDrawMode
'							- RBNSetControlDrawModeIdx -> RBNControlSetDrawModeIdx
'							- RBNSetControlMICursor -> RBNControlSetMICursor
'							- RBNSetControlMICursorIdx -> RBNControlSetMICursorIdx
'							- RBNEnableControl -> RBNControlEnable
'							- RBNEnableControlIdx -> RBNControlEnableIdx
'							- RBNEnableControlsName -> RBNGroupEnableControls
'							- RBNEnableControlName -> RBNGroupEnableControl
'							- RBNGetGroup -> RBNTabGetGroup
'							- RBNGetGroupIndex -> RBNTabGetGroupIndex
'							- RBNGroupExists -> RBNTabGroupExists
'							- RBNGetGalleryGroup -> RBNGalleryGetGroup
'							- RBNGetGalleryGroupIndex -> RBNGalleryGetGroupIndex
'							- RBNSplitButtonGetGroup -> RBNSplitButtonGetGroup
'							- RBNGetSplitButtonGroupIndex -> RBNSplitButtonGetGroupIndex
'							- RBNGetControlFromGroup -> RBNGroupGetControl
'							- RBNGetControlIndexFromGroup -> RBNGroupGetControlIndex
'							- RBNGetControlIndex -> RBNControlGetIndex
'							- RBNGetControlIndexFromCollection -> RBNCollectionGetControlIndex
'							- RBNShowNotification -> RBNNotificationShow
'	02-01-2015 12:37:12		- Added declare for ObjectToString
'						- Added:
'							- RBNControlCheck(...)
'							- RBNControlCheckIdx(...)
'							- RBNMapMiniToolbarInsertControl(...) As Integer
'							- RBNMapMiniToolbarInsertControlAfter(...) As Integer
'							- RBNMapMiniToolbarInsertControlBefore(...) As Integer
'							- RBNMapMiniToolbarGetControlIndex(...) As Integer
'						- Renamed:
'							- RBNMapMiniToolbarAddControl 		-> RBNMapMTBAddControl
'							- RBNMapMiniToolbarInsertControl		-> RBNMapMTBInsertControl
'							- RBNMapMiniToolbarInsertControlAfter	-> RBNMapMTBInsertControlAfter
'							- RBNMapMiniToolbarInsertControlBefore	-> RBNMapMTBInsertControlBefore
'							- RBNMapMiniToolbarRemoveControl		-> RBNMapMTBRemoveControl
'							- RBNMapMiniToolbarAddButton			-> RBNMapMTBAddButton
'							- RBNMapMiniToolbarGetControlIndex		-> RBNMapMTBGetControlIndex
'							- RBNSplitButtonGetGroup				-> RBNSplitButtonGetGroupThs
'	06-01-2015 10:16:52		- Renamed:
'							- RBNTabSetToolTipName			-> RBNTabSetToolTip
'							- RBNTabGetGroup 				-> RBNTabGetGroupThs
'							- RBNTabGetGroupIndex			-> RBNTabGetGroupIndexThs
'							- RBNTabGroupExists				-> RBNTabGroupExistsThs
'							- RBNGroupSetToolTipName			-> RBNGroupSetToolTip
'							- RBNGroupGetControl			-> RBNGroupGetControlThs
'							- RBNGroupGetControlIndex		-> RBNGroupGetControlIndexThs
'							- RBNSplitButtonGetGroupIndex		-> RBNSplitButtonGetGroupIndexThs
'							- RBNSplitButtonGroupExists		-> RBNSplitButtonGroupExistsThs
'							- RBNGalleryGetGroup			-> RBNGalleryGetGroupThs
'							- RBNGalleryGetGroupIndex		-> RBNGalleryGetGroupIndexThs
'							- RBNGalleryGroupExists			-> RBNGalleryGroupExistsThs
'							- RBNCollectionGetControlIndex	-> RBNCollectionGetControlIndexThs
'							- RBNControlSetToolTip			-> RBNControlSetToolTipThs
'							- RBNControlSetKeyGesture		-> RBNControlSetKeyGestureThs
'							- RBNControlSetIcons			-> RBNControlSetIconsThs
'							- RBNControlSetLeftMargin		-> RBNControlSetLeftMarginThs
'							- RBNControlSetCustomMBXHandler	-> RBNControlSetCustomMBXHandlerThs
'							- RBNControlSetDrawMode			-> RBNControlSetDrawModeThs
'							- RBNControlSetMICursor			-> RBNControlSetMICursorThs
'							- RBNControlEnable				-> RBNControlEnableThs
'							- RBNControlCheck				-> RBNControlCheckThs
'							- The parameters sName to a more clear name, such as sControlName, sGroupName etc.
'						- Added:
'							- RBNTabGetGroup(...) As Logical
'							- RBNTabGetGroupIndex(...) As Integer
'							- RBNTabGroupExists(...) As Logical
'	10-01-2015 09:54:49		- Added:
'							- RBNTabExistsCaption(...) As Logical
'							- RBNTabGetNameFromCaption(...) As String
'							- RBNTabEnableThs(...)
'							- RBNTabEnableIdx(...)
'							- RBNTabSetToolTipThs(...)
'							- RBNGroupEnableThs(...)
'							- RBNGroupEnableIdx(...)
'							- RBNGroupSetToolTipThs(...)
'						- Removed:
'							- RBNGetTableEventArgsTableAlias
'	08-02-2015 16:11:22		- Added:
'							- RBNControlSetCmdIDThs(...)	'For setting the ID of the control, used by CommandInfo
'							- RBNControlSetCmdIDIdx(...)	'For setting the ID of the control, used by CommandInfo
'							- RBNControlGetControlIDThs(...) 'Will return the ID of the control used CommandInfo(CMD_INFO_MENUITEM) and CommandInfo(CMD_INFO_TOOLBTN)
'							- RBNControlGetControlIDIdx(...) 'Will return the ID of the control used CommandInfo(CMD_INFO_MENUITEM) and CommandInfo(CMD_INFO_TOOLBTN)
'	30-03-2015 21:07:19		- Added:
'							- RBNDropDButtonNumGroups(...) As Integer
'							- RBNDropDButtonAddGroup(...) As Integer
'							- RBNDropDButtonGroupRemove(...) As Integer
'							- RBNDropDButtonGetGroupThs(...) As Logical
'							- RBNDropDButtonGetGroupIndexThs(...) As Integer
'							- RBNDropDButtonGroupExistsThs(...) As Logical
'							- RBNDropDButtonGroupAddControl(...) As Integer
'							- RBNDropDButtonGroupRemoveControl(...) As Integer
'	28-04-2015 15:49:48		- Added:
'							- RBNControlToggleThs(...)
'							- RBNControlToggleIdx(...)
'	29-04-2015 10:11:46		- Added:
'							- RBNControlSelectedThs(...)
'							- RBNControlSelectedIdx(...)
'						- Added:
'							- RBNMapMTBNumStackPanels() As Integer
'							- RBNMapMTBAddStackPanel(...) As Integer
'							- RBNMapMTBStackPanelRemove(...) As Integer
'							- RBNMapMTBGetStackPanel(...) As Logical
'							- RBNMapMTBGetStackPanelIndex(...) As Integer
'							- RBNMapMTBStackPanelExists(...) As Logical
'							- RBNMapMTBInsertStackPanelAfter(...) As Logical
'							- RBNMapMTBInsertStackPanelBefore(...) As Logical
'						- Added:
'							- RBNMapMTBStackPanelAddControl(...) As Integer
'							- RBNMapMTBStackPanelRemoveControl(...) As Integer
'	19-08-2015 14:00:00		- Changed RBNLoop to write to a specific file instead of via DEBUGPrint()
'	20-08-2015 09:55:15		- Added:
'							- RBNLoopCreateRibbonStatements for creating MapBasic statements to create the full Ribbon
'								This will create the statements for recreating most of the ribbon using the RibbonLib
'								However some control types aren't yet supported and therefor ignore, such as the Gallery
'								Also it's not possible to extract all informations from the Ribbon, certain information
'								will set to a generic value, such as the ToolTips, the Menu Command ID and the Image
'								Some of the controls have been assigned the matching image, but not all
'							- RBNControlGetSizeThs(...) As Integer
'							- RBNSelectTab(...)
'	21-08-2015 14:48:08		- Added ParentControlType to the Elements arrays - to be able to remove controls from SplitButton and DropDButtons
'						- Fixed RBNClearCustomRibbonElements to better support SplitButton and DropDButton Controls
'	27-08-2015 13:05:04		- Added:
'							- RBNTabSetVisibility(...)
'							- RBNTabSetVisibilityThs(...)
'							- RBNTabSetVisibilityIdx(...)
'							- RBNGroupSetVisibilityThs(...)
'							- RBNGroupSetVisibilityIdx(...)
'							- RBNGroupSetVisibility(...)
'	08-09-2015 14:28:50		- Added:
'							- RBNCntxtMenuAddControl(...) As Integer
'							- RBNCntxtMenuInsertControl(...) As Integer
'							- RBNCntxtMenuInsertControlAfter(...) As Integer
'							- RBNCntxtMenuInsertControlBefore(...) As Integer
'							- RBNCntxtMenuAddMenuItem(...) As Integer
'							- RBNCntxtMenuInsertMenuItem(...) As Integer
'							- RBNCntxtMenuInsertMenuItemAfter(...) As Integer
'							- RBNCntxtMenuInsertMenuItemBefore(...) As Integer
'							- RBNCntxtMenuRemoveControl(...) As Integer
'							- RBNCntxtMenuGetControlIndex(...) As Integer
'	30-09-2015 08:15:24		- Added:
'							- RBNControlSetCaptionThs(...)
'							- RBNControlSetCaption(...)
'	08-12-2015 15:23:12		- Added:
'							- RBNGroupCheckControls(...)
'							- RBNGroupCheckControl(...)
'	10-12-2015 15:06:51		- Added:
'							- RBNGroupShowControls(...)
'							- RBNGroupShowControl(...)
'	14-12-2015 08:49:58		- Added:
'							- RBNGroupSelectControl(...)
'							- RBNGroupRunMenuCommandControl(...)
'							- RBNGroupGetFirstControlIdx(...) As Integer
'							- RBNGroupGetNextControlIdx(...) As Integer
'***********************************************************************************************


'Requires MapInfo Pro 12.5 x64
' mapInfoApplication has a Ribbon
' theRibbon As a collection of Tabs
' theTabCollection holds a number of Tabs
' a Tab has a collection of Groups
' a GroupCollection holds a numer of Controls
' a Control can be of a number of types
'
'mapInfoApplication has a collection of running mapBasicApps
'the mapBasicCollection holds a number of mapBasicApps



'**** A D D I N G    T A B S  ,    G R O U P S    A N D    C O N T R O L S
'	nCtrlIdx = RBNGroupAddButton("exportMapToExcel", "MS Excel", "TabMap", "MapClipboard")
'	If nCtrlIdx > 0 Then
'		'Create & Set the button tooltip
'		Call RBNSetControlToolTipIdx(nCtrlIdx, RESSTRNGGetString(STR_MNU_EXPORT_MAP_TO_XLS), "", "")
'		'Set the button icon
'		Call RBNSetControlIconsIdx(nCtrlIdx, TRUE, PATH_IMAGES & "MapWindowExcel_16.bmp", PATH_IMAGES & "MapWindowExcel_24.bmp")
'		'Set Custom MapBasic Handle to the button
'		Call RBNSetControlCustomMBXHandlerIdx(nCtrlIdx, "MENUExportMapWindowToExcel")
'	End If
'
'	nCtrlIdx = RBNGroupInsertButtonBefore("exportBrowserToExcel", "MS Excel", "TabTable", "TableData", "ExportButton")
'	If nCtrlIdx > 0 Then
'		'Create & Set the button tooltip
'		Call RBNSetControlToolTipIdx(nCtrlIdx, RESSTRNGGetString(STR_MNU_EXPORT_BROWSER_TO_XLS), "", "")
'		'Set the button icon
'		Call RBNSetControlIconsIdx(nCtrlIdx, FALSE, PATH_IMAGES & "BrowserWindowExcel_16.bmp", PATH_IMAGES & "BrowserWindowExcel_24.bmp")
'		'Set Custom MapBasic Handle to the button
'		Call RBNSetControlCustomMBXHandlerIdx(nCtrlIdx, "MENUExportBrowserDataToExcel")
'	End If
'
'	If RBNAddTab("TabTools", "TOOLS", "TO") > 0 Then
'		If RBNTabAddGroup(xProgramMenu, xProgramMenu, "TabTools") > 0 Then
'			nCtrlIdx = RBNGroupAddButton("exportTableToExcel", "Table", "TabTools", xProgramMenu)
'			If nCtrlIdx > 0 Then
'				'Create & Set the button tooltip
'				Call RBNSetControlToolTipIdx(nCtrlIdx, RESSTRNGGetString(STR_MNU_EXPORT_TAB_TO_XLS), "", "")
'				'Set the button icon
'				Call RBNSetControlIconsIdx(nCtrlIdx, TRUE, PATH_IMAGES & "BrowserWindowExcel_16.bmp", PATH_IMAGES & "BrowserWindowExcel_24.bmp")
'				'Set Custom MapBasic Handle to the button
'				Call RBNSetControlCustomMBXHandlerIdx(nCtrlIdx, "MENUExportTableToExcel")
'			End If
'		End if
'	End if
'
'**** C L E A R I N G    T H E    A D D E D    T A B S  ,    G R O U P S    A N D    C O N T R O L S
'	Call RBNClearCustomRibbonElements


Define		RBN_ELEMENT_NOT_FOUND		-1
Define		RBN_ELEMENT_INSERT_AS_LAST	-9999

Define		CONTROL_SIZE_EXTRASMALL	1
Define		CONTROL_SIZE_SMALL		2
Define		CONTROL_SIZE_LARGE		3

Define		CONTROL_TYPE_RLIB_TAB		100
Define		CONTROL_TYPE_RLIB_GROUP		101
Define		CONTROL_TYPE_RLIB_CNTXT_MNU	200

Declare Method ObjectToString Class "System.Object" Lib "mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" alias ToString (ByVal objectInstace As This) As String

'**For testing and for getting the names of the controls and elements
Declare Sub RBNLoop
Declare Sub RBNLoopCreateRibbonStatements
Declare Sub RBNLoopContext

Declare Function RBNControlGetTypeName(ByVal nCtrlType As Integer) As String

'** WORKING WITH TABS ***************************************************************************
Declare Function RBNAddTab(		  ByVal sTabName As String
							, ByVal sCaption As String
							, ByVal sKeytip As String
							) As Integer					'Returns the modular Idx of the tab or 0, if it wasn't created
Declare Function RBNRemoveTab(	  ByVal sTabName As String
							) As Integer
Declare Function RBNGetTab(	  ByVal sTabName As String
						, rbnTabFound As RefPtr
						) As Logical
Declare Function RBNGetTabIndex(	ByVal sTabName As String
							) As Integer
Declare Function RBNTabExists(	  ByVal sTabName As String
							) As Logical
Declare Sub RBNSelectTab(	  ByVal sTabName As String)

Declare Function RBNTabExistsCaption(	  ByVal sTabCaption As String
								) As Logical
Declare Function RBNTabGetNameFromCaption(	  ByVal sTabCaption As String
									) As String				'Returns "" if tab isn't found

'** WORKING WITH GROUPS ON TABS *****************************************************************
Declare Function RBNTabNumGroups(  ByVal sTabName As String
							) As Integer
Declare Sub RBNTabSetToolTipThs(	  rbnTab As This
							, ByVal sText As String
							, ByVal sDescription As String
							, ByVal sDisabledText As String)
Declare Sub RBNTabSetToolTip(	  ByVal sTabName As String
						, ByVal sText As String
						, ByVal sDescription As String
						, ByVal sDisabledText As String)
Declare Sub RBNTabSetToolTipIdx(	  ByVal nTabIdx As Integer		'The tabIdx returned by RBNAddTab
							, ByVal sText As String
							, ByVal sDescription As String
							, ByVal sDisabledText As String
							)
Declare Sub RBNTabEnableThs(	  ByVal rbnTab As This
						, ByVal bEnabled As Logical)
Declare Sub RBNTabEnableIdx(	  ByVal nTabIdx As Integer
						, ByVal bEnabled As Logical)
Declare Sub RBNTabSetVisibilityThs(  ByVal rbnTab As This
							, ByVal bVisible As Logical)
Declare Sub RBNTabSetVisibilityIdx(  ByVal nTabIdx As Integer
							, ByVal bVisible As Logical)
Declare Sub RBNTabSetVisibility(	  ByVal sTabName As String
							, ByVal bVisible As Logical)

Declare Function RBNTabAddGroup(	  ByVal sGroupName As String
							, ByVal sCaption As String
							, ByVal sTabName As String
							) As Integer					'Returns the modular Idx of the group or 0, if it wasn't created
Declare Function RBNTabGroupRemove(  ByVal sGroupName As String
							, ByVal sTabName As String
							) As Integer
Declare Function RBNTabGetGroupThs(  rbnTab As This
							, ByVal sGroupName As String
							, rbnGroupFound As RefPtr
							) As Logical
Declare Function RBNTabGetGroup(	  ByVal sTabName As String
							, ByVal sGroupName As String
							, rbnGroupFound As RefPtr
							) As Logical
Declare Function RBNTabGetGroupIndex(	  ByVal sTabName As String
								, ByVal sGroupName As String
								) As Integer
Declare Function RBNTabGetGroupIndexThs(  rbnTab As This
								, ByVal sGroupName As String
								) As Integer
Declare Function RBNTabGroupExists(  ByVal sTabName As String
							, ByVal sGroupName As String
							) As Logical
Declare Function RBNTabGroupExistsThs(	  rbnTab As This
								, ByVal sGroupName As String
								) As Logical

'** WORKING WITH CONTROLS AND BUTTONS ON GROUPS *************************************************
Declare Function RBNGroupNumControls(	  ByVal sGroupName As String
								, ByVal sTabName As String
								) As Integer
Declare Sub RBNGroupSetToolTipThs(	  rbnGroup As This
							, ByVal sText As String
							, ByVal sDescription As String
							, ByVal sDisabledText As String)
Declare Sub RBNGroupSetToolTip(	  ByVal sTabName As String
							, ByVal sGroupName As String
							, ByVal sText As String
							, ByVal sDescription As String
							, ByVal sDisabledText As String)
Declare Sub RBNGroupSetToolTipIdx(	  ByVal nGroupIdx As Integer		'The groupIdx returned by RBNTabAddGroup
							, ByVal sText As String
							, ByVal sDescription As String
							, ByVal sDisabledText As String
							)
Declare Sub RBNGroupEnableThs(	  ByVal rbnGroup As This
							, ByVal bEnabled As Logical)
Declare Sub RBNGroupEnableIdx(	  ByVal nElementIdx As Integer
							, ByVal bEnabled As Logical)
Declare Sub RBNGroupSetVisibilityThs(	  ByVal rbnGroup As This
								, ByVal bVisible As Logical)
Declare Sub RBNGroupSetVisibilityIdx(	  ByVal nElementIdx As Integer
								, ByVal bVisible As Logical)
Declare Sub RBNGroupSetVisibility(	  ByVal sTabName As String
							, ByVal sGroupName As String
							, ByVal bVisible As Logical)

Declare Function RBNGroupAddControl(	  ByVal sControlName As String
								, ByVal sCaption As String
								, ByVal sKeytip As String
								, ByVal nControlType As Integer
								, ByVal sTabName As String
								, ByVal sGroupName As String
								) As Integer					'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNGroupRemoveControl(	  ByVal sControlName As String
								, ByVal sTabName As String
								, ByVal sGroupName As String
								) As Integer
Declare Function RBNGroupInsertControl(	  ByVal sControlName As String
								, ByVal sCaption As String
								, ByVal sKeytip As String
								, ByVal nControlType As Integer
								, ByVal sTabName As String
								, ByVal sGroupName As String
								, ByVal nPosition As Integer
								) As Integer
Declare Function RBNGroupInsertControlAfter(	  ByVal sControlName As String
									, ByVal sCaption As String
									, ByVal sKeytip As String
									, ByVal nControlType As Integer
									, ByVal sTabName As String
									, ByVal sGroupName As String
									, ByVal sNameAfter As String
									) As Integer				'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNGroupInsertControlBefore(  ByVal sControlName As String
									, ByVal sCaption As String
									, ByVal sKeytip As String
									, ByVal nControlType As Integer
									, ByVal sTabName As String
									, ByVal sGroupName As String
									, ByVal sNameBefore As String
									) As Integer				'Returns the modular Idx of the control or 0, if it wasn't created

Declare Function RBNGroupAddButton(  ByVal sControlName As String
							, ByVal sCaption As String
							, ByVal sKeytip As String
							, ByVal sTabName As String
							, ByVal sGroupName As String
							) As Integer					'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNGroupInsertButton(	  ByVal sControlName As String
								, ByVal sCaption As String
								, ByVal sKeytip As String
								, ByVal sTabName As String
								, ByVal sGroupName As String
								, ByVal nPosition As Integer
								) As Integer					'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNGroupInsertButtonAfter(	  ByVal sControlName As String
									, ByVal sCaption As String
									, ByVal sKeytip As String
									, ByVal sTabName As String
									, ByVal sGroupName As String
									, ByVal sNameAfter As String
									) As Integer				'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNGroupInsertButtonBefore(	  ByVal sControlName As String
									, ByVal sCaption As String
									, ByVal sKeytip As String
									, ByVal sTabName As String
									, ByVal sGroupName As String
									, ByVal sNameBefore As String
									) As Integer				'Returns the modular Idx of the control or 0, if it wasn't created
Declare Sub RBNGroupEnableControls(  ByVal sTabName As String		'If "", the TAB is ignored in the search
							, ByVal sGroupName As String		'If "", the GROUP is ignored in the search
							, ByVal sControlName As String
							, ByVal bEnabled As Logical)
Declare Sub RBNGroupEnableControl(	  ByVal sTabName As String		'If "", the TAB is ignored in the search and the first match is used
							, ByVal sGroupName As String		'If "", the GROUP is ignored in the search and the first match is used
							, ByVal sControlName As String
							, ByVal bEnabled As Logical)
Declare Sub RBNGroupCheckControls(	  ByVal sTabName As String
							, ByVal sGroupName As String
							, ByVal sControlName As String
							, ByVal bChecked As Logical)
Declare Sub RBNGroupCheckControl(	  ByVal sTabName As String
							, ByVal sGroupName As String
							, ByVal sControlName As String
							, ByVal bChecked As Logical)
Declare Sub RBNGroupShowControls(  ByVal sTabName As String		'If "", the TAB is ignored in the search
							, ByVal sGroupName As String		'If "", the GROUP is ignored in the search
							, ByVal sControlName As String
							, ByVal bVisible As Logical)
Declare Sub RBNGroupShowControl(	  ByVal sTabName As String		'If "", the TAB is ignored in the search and the first match is used
							, ByVal sGroupName As String		'If "", the GROUP is ignored in the search and the first match is used
							, ByVal sControlName As String
							, ByVal bVisible As Logical)
Declare Sub RBNGroupSelectControl(	  ByVal sTabName As String
							, ByVal sGroupName As String
							, ByVal sControlName As String)
Declare Sub RBNGroupRunMenuCommandControl(	  ByVal sTabName As String
									, ByVal sGroupName As String
									, ByVal sControlName As String)

Declare Function RBNGroupGetFirstControlIdx(	  ByVal sTabName As String
									, ByVal sGroupName As String
									, ByVal sControlName As String) As Integer
Declare Function RBNGroupGetNextControlIdx(	  ByVal sTabName As String
									, ByVal sGroupName As String
									, ByVal sControlName As String) As Integer

Declare Function RBNGroupGetControl(	  ByVal sTabName As String
								, ByVal sGroupName As String
								, ByVal sControlName As String
								, rbnControlFound As RefPtr
								) As Logical
Declare Function RBNGroupGetControlThs(  rbnGroup As This
								, ByVal sControlName As String
								, rbnControlFound As RefPtr
								) As Logical
Declare Function RBNGroupGetControlIndexThs(	  rbnGroup As This
									, ByVal sControlName As String
									) As Integer

'** WORKING WITH SPLITBUTTONS *******************************************************************
Declare Function RBNSplitButtonNumGroups( ByVal sTabName As String
								, ByVal sGroupName As String
								, ByVal sSplitButtonName As String
								) As Integer

Declare Function RBNSplitButtonAddGroup(  ByVal sSplitButtonGroupName As String
								, ByVal sCaption As String
								, ByVal sTabName As String
								, ByVal sGroupName As String
								, ByVal sSplitButtonName As String
								) As Integer					'Returns the modular Idx of the group or 0, if it wasn't created
Declare Function RBNSplitButtonGroupRemove(	  ByVal sSplitButtonGroupName As String
									, ByVal sTabName As String
									, ByVal sGroupName As String
									, ByVal sSplitButtonName As String
									) As Integer
Declare Function RBNSplitButtonGetGroupThs(	  rbnSplitButton As This
									, ByVal sGroupName As String
									, rbnGroupFound As RefPtr
									) As Logical
Declare Function RBNSplitButtonGetGroupIndexThs(  rbnSplitButton As This
									, ByVal sGroupName As String
									) As Integer
Declare Function RBNSplitButtonGroupExistsThs(	  rbnSplitButton As This
									, ByVal sGroupName As String
									) As Logical

'** WORKING WITH CONTROLS ON SPLITBUTTON GROUPS ************************************************
Declare Function RBNSplitButtonGroupAddControl(	  ByVal sControlName As String
										, ByVal sCaption As String
										, ByVal sKeytip As String
										, ByVal nControlType As Integer
										, ByVal sTabName As String
										, ByVal sGroupName As String
										, ByVal sSplitButtonName As string
										, ByVal sSplitButtonGroupName As string
										) As Integer					'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNSplitButtonGroupRemoveControl(  ByVal sControlName As String
										, ByVal sTabName As String
										, ByVal sGroupName As String
										, ByVal sSplitButtonName As string
										, ByVal sSplitButtonGroupName As string
										) As Integer

'** WORKING WITH DROPDOWNBUTTONS ****************************************************************
Declare Function RBNDropDButtonNumGroups( ByVal sTabName As String
								, ByVal sGroupName As String
								, ByVal sDropDButtonName As String
								) As Integer

Declare Function RBNDropDButtonAddGroup(  ByVal sDropDButtonGroupName As String
								, ByVal sCaption As String
								, ByVal sTabName As String
								, ByVal sGroupName As String
								, ByVal sDropDButtonName As String
								) As Integer					'Returns the modular Idx of the group or 0, if it wasn't created
Declare Function RBNDropDButtonGroupRemove(	  ByVal sDropDButtonGroupName As String
									, ByVal sTabName As String
									, ByVal sGroupName As String
									, ByVal sDropDButtonName As String
									) As Integer
Declare Function RBNDropDButtonGetGroupThs(	  rbnDropDButton As This
									, ByVal sGroupName As String
									, rbnGroupFound As RefPtr
									) As Logical
Declare Function RBNDropDButtonGetGroupIndexThs(  rbnDropDButton As This
									, ByVal sGroupName As String
									) As Integer
Declare Function RBNDropDButtonGroupExistsThs(	  rbnDropDButton As This
									, ByVal sGroupName As String
									) As Logical

'** WORKING WITH CONTROLS ON DROPDOWNBUTTON GROUPS **********************************************
Declare Function RBNDropDButtonGroupAddControl(	  ByVal sControlName As String
										, ByVal sCaption As String
										, ByVal sKeytip As String
										, ByVal nControlType As Integer
										, ByVal sTabName As String
										, ByVal sGroupName As String
										, ByVal sDropDButtonName As string
										, ByVal sDropDButtonGroupName As string
										) As Integer					'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNDropDButtonGroupRemoveControl(  ByVal sControlName As String
										, ByVal sTabName As String
										, ByVal sGroupName As String
										, ByVal sDropDButtonName As string
										, ByVal sDropDButtonGroupName As string
										) As Integer

'** WORKING WITH CONTEXTGROUPS *****************************************************************
Declare Function RBNGetContextGroup( rbnTab As This
							, ByVal sGroupName As String
							, rbnGroupFound As RefPtr
							) As Logical

'** WORKING WITH CONTROLS ON CONTEXTGROUPS *****************************************************
Declare Function RBNContextGroupAddButton(	  ByVal sControlName As String
									, ByVal sCaption As String
									, ByVal sKeytip As String
									, ByVal sTabName As String
									, ByVal sGroupName As String
									) As Integer

'** WORKING WITH MENUITEMS ON TOOLCONTEXTMENU **************************************************
Declare Function RBNToolContextMenuAddMenuItem(	  ByVal sControlName As String
										, ByVal sCaption As String
										, ByVal sKeytip As String
										) As Integer					'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNToolContextMenuRemoveMenuItem(  ByVal sControlName As String
										) As Integer

'** WORKING WITH MENUITEMS ON CONTEXTMENUS *****************************************************
Declare Function RBNCntxtMenuAddControl(	  ByVal nContextMenuID As Integer
									, ByVal sControlName As String
									, ByVal sCaption As String
									, ByVal sKeytip As String
									, ByVal nControlType As Integer
									) As Integer				'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNCntxtMenuInsertControl(	  ByVal nContextMenuID As Integer
									, ByVal sControlName As String
									, ByVal sCaption As String
									, ByVal sKeytip As String
									, ByVal nControlType As Integer
									, ByVal nPosition As Integer
									) As Integer				'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNCntxtMenuInsertControlAfter(	  ByVal nContextMenuID As Integer
										, ByVal sControlName As String
										, ByVal sCaption As String
										, ByVal sKeytip As String
										, ByVal nControlType As Integer
										, ByVal sNameAfter As String
										) As Integer				'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNCntxtMenuInsertControlBefore(	  ByVal nContextMenuID As Integer
										, ByVal sControlName As String
										, ByVal sCaption As String
										, ByVal sKeytip As String
										, ByVal nControlType As Integer
										, ByVal sNameBefore As String
										) As Integer				'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNCntxtMenuAddMenuItem(	  ByVal nContextMenuID As Integer
									, ByVal sControlName As String
									, ByVal sCaption As String		'If "(-" then a separator is added
									, ByVal sKeytip As String
									, ByVal nControlType As Integer
									) As Integer					'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNCntxtMenuInsertMenuItem(	  ByVal nContextMenuID As Integer
									, ByVal sControlName As String
									, ByVal sCaption As String		'If "(-" then a separator is added
									, ByVal sKeytip As String
									, ByVal nPosition As Integer
									) As Integer				'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNCntxtMenuInsertMenuItemAfter(	  ByVal nContextMenuID As Integer
										, ByVal sControlName As String
										, ByVal sCaption As String		'If "(-" then a separator is added
										, ByVal sKeytip As String
										, ByVal sNameAfter As String
										) As Integer				'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNCntxtMenuInsertMenuItemBefore(  ByVal nContextMenuID As Integer
										, ByVal sControlName As String
										, ByVal sCaption As String		'If "(-" then a separator is added
										, ByVal sKeytip As String
										, ByVal sNameBefore As String
										) As Integer				'Returns the modular Idx of the control or 0, if it wasn't created

Declare Function RBNCntxtMenuRemoveControl(	  ByVal nContextMenuID As Integer
									, ByVal sControlName As String
									) As Integer					'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNCntxtMenuGetControlIndex(  ByVal nContextMenuID As Integer
									, ByVal sControlName As String
									) As Integer


'** WORKING WITH STACKPANELS ON MINI MAP TOOLBAR **********************************************
Declare Function RBNMapMTBNumStackPanels() As Integer

Declare Function RBNMapMTBAddStackPanel(	  ByVal sStackPanelName As String
									, ByVal sCaption As String
									) As Integer					'Returns the modular Idx of the StackPanel or 0, if it wasn't created
Declare Function RBNMapMTBInsertStackPanelAfter(	  ByVal sStackPanelName As String
										, ByVal sCaption As String
										, ByVal sNameAfter As String
										) As Logical
Declare Function RBNMapMTBInsertStackPanelBefore( ByVal sStackPanelName As String
										, ByVal sCaption As String
										, ByVal sNameBefore As String
										) As Logical
Declare Function RBNMapMTBStackPanelRemove(	  ByVal sStackPanelName As String
									) As Integer
Declare Function RBNMapMTBGetStackPanel(	 ByVal sStackPanelName As String
									, rbnsStackPanelFound As RefPtr
									) As Logical
Declare Function RBNMapMTBGetStackPanelIndex(  ByVal sStackPanelName As String
									) As Integer
Declare Function RBNMapMTBStackPanelExists(	  ByVal sStackPanelName As String
									) As Logical

'** WORKING WITH CONTROLS AND BUTTONS ON MINI MAP TOOLBAR ***************************************
Declare Function RBNMapMTBAddControl(	  ByVal sControlName As String
								, ByVal sCaption As String
								, ByVal sKeytip As String
								, ByVal nControlType As Integer
								) As Integer					'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNMapMTBInsertControl(  ByVal sControlName As String
								, ByVal sCaption As String
								, ByVal sKeytip As String
								, ByVal nControlType As Integer
								, ByVal nPosition As Integer
								) As Integer
Declare Function RBNMapMTBInsertControlAfter(  ByVal sControlName As String
									, ByVal sCaption As String
									, ByVal sKeytip As String
									, ByVal nControlType As Integer
									, ByVal sNameAfter As String
									) As Integer
Declare Function RBNMapMTBInsertControlBefore( ByVal sControlName As String
									, ByVal sCaption As String
									, ByVal sKeytip As String
									, ByVal nControlType As Integer
									, ByVal sNameBefore As String
									) As Integer
Declare Function RBNMapMTBRemoveControl(  ByVal sControlName As String
								) As Integer
Declare Function RBNMapMTBAddButton( ByVal sControlName As String
							, ByVal sCaption As String
							, ByVal sKeytip As String
							) As Integer					'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNMapMTBGetControlIndex(	  ByVal sControlName As String
									) As Integer

'** WORKING WITH CONTROLS ON STACKPANEL ON MINI MAP TOOLBAR ************************************
Declare Function RBNMapMTBStackPanelAddControl(	  ByVal sControlName As String
										, ByVal sCaption As String
										, ByVal sKeytip As String
										, ByVal nControlType As Integer
										, ByVal sStackPanelName As string
										) As Integer					'Returns the modular Idx of the control or 0, if it wasn't created
Declare Function RBNMapMTBStackPanelRemoveControl(  ByVal sControlName As String
										, ByVal sStackPanelName As string
										) As Integer

'** WORKING WITH GALLERY ***********************************************************************
Declare Function RBNGalleryGetGroupThs(	  rbnGallery As This
								, ByVal sGroupName As String
								, rbnGroupFound As RefPtr
								) As Logical
Declare Function RBNGalleryGetGroupIndexThs(	  rbnGallery As This
									, ByVal sGroupName As String
									) As Integer
Declare Function RBNGalleryGroupExistsThs(	  rbnGallery As This
									, ByVal sGroupName As String
									) As Logical

'** WORKING WITH COLLECTIONS *******************************************************************
Declare Function RBNCollectionGetControlIndexThs(	  rbnControlsColl As this
										, ByVal sControlName As String
										) As Integer

'** WORKING WITH CONTROLS **********************************************************************
Declare Sub RBNControlSetToolTipThs( rbnControl As This
							, ByVal sDescription As String
							, ByVal sText As String
							, ByVal sDisabledText As String)
Declare Sub RBNControlSetToolTipIdx( ByVal nElementIdx As Integer
							, ByVal sDescription As String
							, ByVal sText As String
							, ByVal sDisabledText As String)
Declare Sub RBNControlSetKeyGestureThs(	  rbnControl As This
								, ByVal sGesture As String		'For example "Ctrl+Y", "Alt+Ctrl+Y"
								)
Declare Sub RBNControlSetKeyGestureIdx(	  ByVal nElementIdx As Integer
								, ByVal sGesture As String		'For example "Ctrl+Y", "Alt+Ctrl+Y"
								)
Declare Sub RBNControlSetCaptionThs( rbnControl As This
							, ByVal sCaption As String		'The Caption to to be seen in the Ribbon
							)
Declare Sub RBNControlSetCaption(	  ByVal nElementIdx As Integer
							, ByVal sCaption As String		'The Caption to to be seen in the Ribbon
							)

Declare Function RBNControlGetSizeThs(	  rbnControl As This
								) As Integer
Declare Sub RBNControlSetIconsThs(	  rbnControl As This
							, ByVal nSize As Integer
							, ByVal sSmallIcon As String		'If you omit this, the LargeIcon will be used as the SmallIcon as well
							, ByVal sLargeIcon As String		'If you omit this, the SmallIcon will be used as the LargeIcon as well
							)
Declare Sub RBNControlSetIconsIdx(	  ByVal nElementIdx As Integer
							, ByVal nSize As Integer
							, ByVal sSmallIcon As String		'If you omit this, the LargeIcon will be used as the SmallIcon as well
							, ByVal sLargeIcon As String		'If you omit this, the SmallIcon will be used as the LargeIcon as well
							)

Declare Sub RBNControlSetDefaultLeftMargin(	ByVal fMargin As Float)
Declare Sub RBNControlSetLeftMarginThs(	  rbnControl As This
								, ByVal fMargin As Float
								)
Declare Sub RBNControlSetLeftMarginIdx(	  ByVal nElementIdx As Integer
								, ByVal fMargin As Float
								)

Declare Sub RBNControlSetCustomMBXHandlerThs(  ByVal rbnControl As This
									, ByVal sMBXHandler As String
									)
Declare Sub RBNControlSetCustomMBXHandlerIdx(  ByVal nElementIdx As Integer
									, ByVal sMBXHandler As String
									)
Declare Sub RBNControlSetCmdIDThs(	  ByVal rbnControl As This
							, ByVal nCmdID As Integer
							)
Declare Sub RBNControlSetCmdIDIdx(	  ByVal nElementIdx As Integer
							, ByVal nCmdID As Integer
							)
Declare Sub RBNControlSetDrawModeThs(	  ByVal rbnControl As This
								, ByVal nDrawMode As Integer
								)
Declare Sub RBNControlSetDrawModeIdx(	  ByVal nElementIdx As Integer
								, ByVal nDrawMode As Integer
								)
Declare Sub RBNControlSetMICursorThs(	  ByVal rbnControl As This
								, ByVal nCursor As Integer
								, ByVal sFile As String
								)
Declare Sub RBNControlSetMICursorIdx(	  ByVal nElementIdx As Integer
								, ByVal nCursor As Integer
								, ByVal sFile As String
								)
Declare Sub RBNControlEnableThs(	  ByVal rbnControl As This
							, ByVal bEnabled As Logical
							)
Declare Sub RBNControlEnableIdx(	  ByVal nElementIdx As Integer
							, ByVal bEnabled As Logical
							)
Declare Sub RBNControlSetVisibilityThs(	  ByVal rbnControl As This
								, ByVal bVisible As Logical
								)
Declare Sub RBNControlSetVisibilityIdx(	  ByVal nElementIdx As Integer
								, ByVal bVisible As Logical
								)
Declare Sub RBNControlSetVisibility(	  ByVal sTabName As String
								, ByVal sGroupName As String
								, ByVal sControlName As String
								, ByVal bVisible As Logical
								)

Declare Sub RBNControlCheckThs(	  ByVal rbnControl As This
							, ByVal bChecked As Logical
							)
Declare Sub RBNControlCheckIdx(	  ByVal nElementIdx As Integer
							, ByVal bChecked As Logical
							)
Declare Sub RBNControlSelectedThs(	  ByVal rbnControl As This
							, ByVal bSelected As Logical
							)
Declare Sub RBNControlSelectedIdx(	  ByVal nElementIdx As Integer
							, ByVal bSelected As Logical
							)
Declare Sub RBNControlToggleThs(	  ByVal rbnControl As This
							, ByVal bIsToggle As Logical
							)
Declare Sub RBNControlToggleIdx(	  ByVal nElementIdx As Integer
							, ByVal bIsToggle As Logical
							)

Declare Function RBNControlGetControlIDThs(	  ByVal rbnControl As This
									) As Integer	 'Will return the ID of the control used CommandInfo(CMD_INFO_MENUITEM) and CommandInfo(CMD_INFO_TOOLBTN)
Declare Function RBNControlGetControlIDIdx(	  nElementIdx As Integer
									) As Integer	'Will return the ID of the control used CommandInfo(CMD_INFO_MENUITEM) and CommandInfo(CMD_INFO_TOOLBTN)

Declare Function RBNControlGetIndex(	  ByVal sTabName As String
								, ByVal sGroupName As String
								, ByVal sControlName As String
								) As Integer


'**** CL E A N I N G ***********************************************************************
Declare Sub RBNClearCustomRibbonElements
Declare Sub RBNEndHandler

'**** E V E N T S **************************************************************************
Declare Function RBNEventSubscribe(	  ByVal nEventType As Integer
								, ByVal sMBXHandler As String
								) As Logical
Declare Function RBNEventUnsubscribe(  	  ByVal nEventType As Integer
								, ByVal sMBXHandler As String
								) As Logical
Declare Function RBNEventUnsubscribeAll(
								) As Logical


'**** N O T I F I C A T I O N **************************************************************
Declare Sub RBNNotificationShow(	  ByVal sTitle As String
							, ByVal sMessage As String
							, ByVal nNotificationType As Integer
							, ByVal nTimeToShow As Integer		'If <= 0 then defaults to 10000
							)






'#######################################################################################################################
'#                                                                                                                     #
'#                                                 RibbonElements.DEF                                                  #
'#                                                                                                                     #
'#######################################################################################################################
' --------------------------------------------------------------
' STANDARD TABS
' --------------------------------------------------------------
Define	TAB_HOME					"TabHome"				'HOME'
Define	TAB_TABLE					"TabTable"			'TABLE'
Define	TAB_MAP					"TabMap"				'MAP'
Define	TAB_SPATIAL				"TabSpatial"			'SPATIAL'
Define	TAB_LAYOUT				"TabLayout"			'LAYOUT'
Define	TAB_LEGACY				"TabLegacy"			'LEGACY'

' --------------------------------------------------------------
' STANDARD GROUPS ON 'HOME' TAB
' --------------------------------------------------------------
Define	TAB_GROUP_HOME_FILE			"HomeFile"			'File'
Define	TAB_GROUP_HOME_CLIPBOARD		"HomeClipboard"		'Clipboard'
Define	TAB_GROUP_HOME_WINDOW		"HomeWindow"			'Window'
Define	TAB_GROUP_HOME_OUTPUT		"HomeOutput"			'Output'
Define	TAB_GROUP_HOME_TOOLS		"HomeTools"			'Tools'

' --------------------------------------------------------------
' STANDARD GROUPS ON 'TABLE' TAB
' --------------------------------------------------------------
Define	TAB_GROUP_TABLE_DATA		"TableData"			'Content'
Define	TAB_GROUP_TABLE_SELECTION	"TableSelection"		'Selection'
Define	TAB_GROUP_TABLE_EDIT		"TableAddEdit"			'Edit'
Define	TAB_GROUP_TABLE_BROWSERTOOLS	"BrowserTools"			'Browser Tools'
Define	TAB_GROUP_TABLE_SORTFILTER	"BrowserSortFilter"		'Sort and Filter'
Define	TAB_GROUP_TABLE_MAINTENANCE	"TableMaintenance"		'Maintenance'

'--------------------------------------------------------------
' STANDARD GROUPS ON 'MAP' TAB
' --------------------------------------------------------------
Define	TAB_GROUP_MAP_FILE			"MapFile"				'Content'
Define	TAB_GROUP_MAP_SELECTION		"MapSelection"			'Selection'
Define	TAB_GROUP_MAP_NAVIGATE		"MapNavigate"			'Navigate'
Define	TAB_GROUP_MAP_LABEL			"MapLabel"			'Label'
Define	TAB_GROUP_MAP_ANALYZE		"MapAnalyze"			'Analyze'
Define	TAB_GROUP_MAP_OPTIONS		"MapOptions"			'Options'

'--------------------------------------------------------------
' STANDARD GROUPS ON 'SPATIAL' TAB
' --------------------------------------------------------------
Define	TAB_GROUP_SPATIAL_CLIPBOARD	"SpatialClipboardBar"	'Clipboard'
Define	TAB_GROUP_SPATIAL_SELECTION	"SpatialSelectionBar"	'Selection'
Define	TAB_GROUP_SPATIAL_EDIT		"SpatialEditBar"		'Edit'
Define	TAB_GROUP_SPATIAL_CREATE		"SpatialCreateBar"		'Create'

'--------------------------------------------------------------
' STANDARD GROUPS ON 'LAYOUT' TAB
' --------------------------------------------------------------
Define	TAB_GROUP_LAYOUT_PAGE		"LayoutPage"			'Page'
Define	TAB_GROUP_LAYOUT_EDIT		"LayoutEdit"			'Edit'
Define	TAB_GROUP_LAYOUT_ARRANGE		"LayoutArrange"		'Arrange'
Define	TAB_GROUP_LAYOUT_TOOLS		"LayoutTools"			'Tools'
Define	TAB_GROUP_LAYOUT_LAYERSTYLE	"LayerStyleStyle"		'Style'
Define	TAB_GROUP_LAYOUT_OUTPUT		"LayoutOutput"			'Output'




'#######################################################################################################################
'#                                                                                                                     #
'#                                                     DEFAULTS.DEF                                                    #
'#                                                                                                                     #
'#######################################################################################################################
Define	eye	Chr$(34)
Define	lf	Chr$(10)
Define	ff	Chr$(12)
Define	cr	Chr$(13)
Define	sp	Chr$(32)

DEFINE	CHR_COMMA	","
DEFINE	ESC_COMMA	"ESC_COMMA"
DEFINE	CHR_EQUALS	"="
DEFINE	ESC_EQUALS	"ESC_EQUALS"

DEFINE	ELM_SEP		","
DEFINE	ARG_SEP 	":"

'#######################################################################################################################
'#                                                                                                                     #
'#                                                     ERRORLIB.DEF                                                    #
'#                                                                                                                     #
'#######################################################################################################################
'****************************************************************************************
'	H I S T O R Y    O F     E R R O R L I B
'****************************************************************************************
'11-01-2012 10:37:14	Peter Mller added:
'						- ERRGetDescription(...) As String
'						- ERRGetFullDescription(...) As String
'						- ERRGetLatestDescription(...) As String
'						- ERRGetLatestFullDescription(...) As String
'						- ERRDump
'						- ERRDumpToFile
'					- Now an error also Contains the Date and time of when it occured
'09-10-2014 12:01:08	Peter Mller Added:
'						- ERRGetErrorNo(...) As Integer
'						- ERRGetLatestErrorNo() As Integer
'***************************************************************************************

'**Requires MapInfo Pro 4.0
'**Uses the T_ERROR type to hold the error information internally

Declare Sub ERRCreate(	  ByVal nErrorNo As Integer		'Error number (could be the MapInfo Pro Err()
				, ByVal sErrorText As String		'Error text (could be the MapInfo Pro Error$()
				, ByVal sErrorDescription As String	'Error Description, some more details on the error
				)

'**Returns a specific error code
Declare Function ERRGetErrorNo(ByVal nErrorItem As Integer) As Integer
'**Returns a simple error message, bOnMultipleLines defines if it can be on multiple lines, good for dialogs/notes
Declare Function ERRGetDescription(ByVal nErrorItem As Integer, ByVal bOnMultipleLines As Logical) As String
'**Returns a full error message (including date and time), bOnMultipleLines defines if it can be on multiple lines, good for dialogs/notes
Declare Function ERRGetFullDescription(ByVal nErrorItem As Integer, ByVal bOnMultipleLines As Logical) As String
'**Returns the latest/last error code
Declare Function ERRGetLatestErrorNo() As Integer
'**Returns a simple error message, bOnMultipleLines defines if it can be on multiple lines, good for dialogs/notes
Declare Function ERRGetLatestDescription(ByVal bOnMultipleLines As Logical) As String
'**Returns a full error message (including date and time), bOnMultipleLines defines if it can be on multiple lines, good for dialogs/notes
Declare Function ERRGetLatestFullDescription(ByVal bOnMultipleLines As Logical) As String

'Shows a dialog with the latest error
Declare Sub ERRShow()
'Print the latest error to the message window
Declare Sub ERRPrint()

'**Dumps all the errors to a file picked by the user
Declare Sub ERRDump
'**Dumps all the errors to a specified file
Declare Sub ERRDumpToFile(ByVal sFile As String)



'#######################################################################################################################
'#                                                                                                                     #
'#                                                     T_ERROR.DEF                                                     #
'#                                                                                                                     #
'#######################################################################################################################
'Requires MapInfo Pro 4.0

Type T_ERROR
	nNo			As Integer
	sText			As String
	sDescription	As String
	dDate			As Date
	sTime			As String
	sUser			As String
	sComputer		As String
End Type

Declare Sub terrCopy(	  terrFrom As T_ERROR		'Error type to copy values from
				, terrTo As T_ERROR		'Error type to copy values to
				)
Declare Sub terrReset(	  tError As T_ERROR		'Error to reset
				)
Declare Function terrToString( tError As T_ERROR	'Error to convert to a string
					) As String




'#######################################################################################################################
'#                                                                                                                     #
'#                                                    ARRAYLib.DEF                                                     #
'#                                                                                                                     #
'#######################################################################################################################
'********************************************************************************************************
'  H I S T R Y    O F    A R R A Y L I B
'********************************************************************************************************
'	Created 01-12-2011
'		- Added the basics functions for working with string arrays, add, remove, find and to separated text
'	08-02-2012
'		- Added Sub ARRAYAddValueAsItemString(...)
'		- Added Sub ARRAYMoveItemBetweenArraysString(...)
'		- Changed ARRAYRemoveValueString to remove all instances of the string
'	13-04-2012
'		- Added Sub ARRAYCopyString(...)
'	16-04-2012
'		- added Function ARRAYToQuotedSeparatedTextString(...)
'	26-04-2012
'		- added Sub ARRAYCopyInteger(...)
'	12-11-2012 10:41:49
'		- Added Sub ARRAYAddArrayString(...)
'		- Added Sub ARRAYSortAscString(...)
'		- Added Sub ARRAYSortDescString(...)
'		- Added Function ARRAYFindPositionAscSortedString(...) As Integer
'		- Added Function ARRAYFindPositionDescSortedString(...) As Integer
'		- Added Sub ARRAYAddArrayString(...)
'	07-01-2013 13:43:57
'		- Added Sub ARRAYAddValueInteger(...)
'		- Added Sub ARRAYRemoveItemInteger(...)
'		- Added Sub ARRAYRemoveValueInteger(...)
'		- Added Function ARRAYFindValueInteger(...) As Integer
'		- Added Sub ARRAYAddArrayInteger(...)
'	08-01-2013 12:52:32
'		- Added Function ARRAYToSeparatedTextInteger(...) As String
'		- Added Sub ARRAYQuickSortDescString(...)
'		- Added Sub ARRAYSwapString(...)
'		- ARRAYSortDescString is now using ARRAYQuickSortDescString
'	11-01-2013 10:40:59
'		- Added Sub ARRAYRemoveValuesString(...)
'********************************************************************************************************

'--------------------------------------------------------------------------------------------------------------------------------------------------
'** S T R I N G     A R R A Y S
'--------------------------------------------------------------------------------------------------------------------------------------------------
Declare Sub ARRAYAddValueString(		  arrValues() As String			'Array of values to work on
								, ByVal sNewValue As String		'New string value to insert at a certain position
								)							'The existing values will be maintained - the new value will be added at the end
Declare Sub ARRAYAddValueAsItemString(	  arrValues() As String			'Array of values to work on
								, ByVal sNewValue As String		'New string value to insert at a certain position
								, ByVal nItem As Integer			'The position to insert the value at, -1 it will be added at the end
								)							'The existing values will be maintain but values from nItem and up will be moved by one
Declare Sub ARRAYAddArrayString(		  arrToAdd() As String			'Array of values to copy to the other array
								, arrTo() As String				'Array of values to recieve the values from the first array
								)							'The arrTo will be now hold the original records and the records from the arrToAdd

Declare Sub ARRAYRemoveItemString(		  arrValues() As String			'Array of values to work on
								, ByVal nItem As Integer			'Item to remove from the array
								)							'The existing values will be maintain only the given item with will be removed
Declare Sub ARRAYRemoveValueString(	  arrValues() As String			'Array of values to work on
								, ByVal sValue As String			'String value to remove from the array
								)							'The existing values will be maintain only all items with the given value will be removed
Declare Sub ARRAYRemoveValuesString(	  arrValues() As String			'Array of values to work on
								, arrValuesToRemove() As String	'Array of value to remove from the array
								)							'The existing values will be maintain only all items with the given values will be removed

Declare Sub ARRAYMoveItemBetweenArraysString(  arrFromValues() As String		'Array of values to move the item from
									, ByVal nFromItem As Integer		'The position of the value to move to the to-array
									, arrToValues() As String		'Array of values to move the item to
									, ByVal nToItem As Integer		'The position to insert the value at, -1 it will be added at the end
									)							'The FromArray will have the Item removed and the FromArray will have the Item added

Declare Sub ARRAYSortAscString(	arrValues() As String					'Array to sort, now using QuickSort which is pretty quick
						)
Declare Sub ARRAYSortDescString(	arrValues() As String					'Array to sort, sorting can be slow with huge arrays: 1300 elements: 6 secs, 2600 elements: 24 secs, 5200 elements: 98 secs
						)
Declare Sub ARRAYQuickSortDescString(	  arrValues() As String
								, ByVal nFirst As Integer
								, ByVal nLast As Integer
								)
Declare Sub ARRAYSwapString(s1 As String, s2 As String)

Declare Function ARRAYFindPositionAscSortedString(  ByVal sValue As String		'Value to find position for in the sorted array
										, arrValues() As String		'Sorted array to find position in
										) As Integer				'Returns the position to insert the value into
Declare Function ARRAYFindPositionDescSortedString( ByVal sValue As String		'Value to find position for in the sorted array
										, arrValues() As String		'Sorted array to find position in
										) As Integer				'Returns the position to insert the value into


Declare Function ARRAYContainsValueString(	  arrValues() As String			'Array of values to work on
									, ByVal sValue As String			'String value to find in the array
									) As Logical					'Returns true if the value was found
Declare Function ARRAYFindValueString(		  arrValues() As String			'Array of values to work on
									, ByVal sValue As String			'String value to find in the array
									) As Integer					'The first item that has the value given
Declare Function ARRAYToSeparatedTextString(	  arrValues() As String			'Array of values to work on
									, ByVal sSeparator As String		'Separator to use to separate the string values in the separated string
									) As String					'A string with all values saparated with the sSeparator
Declare Function ARRAYToQuotedSeparatedTextString(  arrValues() As String		'Array of values to work on
										, ByVal sSeparator As String	'Separator to use to separate the string values in the separated string
										, ByVal sQuote As String		'Quote character to put around all string values in the separated string
										) As String				'A string with all values quoted and saparated with the sSeparator

Declare Sub ARRAYCopyString(				  arrFrom() As String			'Array of values to copy to the other array
									, arrTo() As String				'Array of values to recieve the values from the first array
									)							'The arrTo will be resized to contain exactly the same number of elements as the arrFrom

'--------------------------------------------------------------------------------------------------------------------------------------------------
'** I N T E G E R     A R R A Y S
'--------------------------------------------------------------------------------------------------------------------------------------------------
Declare Sub ARRAYAddValueInteger(		  arrValues() As Integer			'Array of values to work on
								, ByVal nNewValue As Integer		'New string value to insert at a certain position
								)							'The existing values will be maintained - the new value will be added at the end
Declare Sub ARRAYRemoveValueInteger(	  arrValues() As Integer			'Array of values to work on
								, ByVal nValue As Integer		'Integer value to remove from the array
								)							'The existing values will be maintain only all items with the given value will be removed
Declare Sub ARRAYRemoveItemInteger(	  arrValues() As Integer			'Array of values to work on
								, ByVal nItem As Integer			'Item to remove from the array
								)							'The existing values will be maintain only the given item with will be removed
Declare Sub ARRAYAddArrayInteger(		  arrToAdd() As Integer			'Array of values to copy to the other array
								, arrTo() As Integer			'Array of values to recieve the values from the first array
								)							'The arrTo will be now hold the original records and the records from the arrToAdd

Declare Function ARRAYFindValueInteger(		  arrValues() As Integer		'Array of values to work on
									, ByVal nValue As Integer	'Integer value to find in the array
									) As Integer				'The first item that has the value given

Declare Function ARRAYToSeparatedTextInteger(  arrValues() As Integer			'Array of values to work on
									, ByVal sSeparator As String		'Separator to use to separate the integer values in the separated string
									) As String					'A string with all values saparated with the sSeparator

Declare Sub ARRAYCopyInteger(			  arrFrom() As Integer			'Array of values to copy to the other array
								, arrTo() As Integer			'Array of values to recieve the values from the first array
								)							'The arrTo will be resized to contain exactly the same number of elements as the arrFrom



'#######################################################################################################################
'#                                                                                                                     #
'#                                                    DEBUGLib.DEF                                                     #
'#                                                                                                                     #
'#######################################################################################################################
'**Requires MapInfo Pro 4.0

DEFINE DEBUG_ALL	100
DEFINE DEBUG_TRACE	200
DEFINE DEBUG_DEBUG	300
DEFINE DEBUG_INFO	400
DEFINE DEBUG_WARN	500
DEFINE DEBUG_ERROR	600
DEFINE DEBUG_FATAL	700
DEFINE DEBUG_OFF	800

'Is been used by the ProgramInfo module

Declare Sub DEBUGEnableByFile(  ByVal sFile As String		'Name of file to exist to enable debug state
					)
Declare Sub DEBUGEnable(	  ByVal bValue As Logical	'Value (true/false) to set the debug state to
					)

Declare Function DEBUGIsEnabled() As Logical			'Returns true if Debug is enabled

Declare Sub DEBUGLevelPrint(	ByVal iDebugLevel As Integer,	'Defined variable that maps to value for debug level
								ByVal iDefaultLevel As Integer,	'Defined variable that maps to default value for debug level
								ByVal sMessage As String		'Message to print to the message window - and write to debug file.
				)

Declare Function DEBUGGetLevelDescription(	ByVal iDebugLevel As Integer	'Map defined variable that to description string value for debug level
				) As String

Declare Function DEBUGGetLevelValue(	ByVal sDebugLevel As String	'Map string variable to integer value for debug level
				) As Integer
				
Declare Sub DEBUGPrint(	  ByVal sMessage As String		'Message to print to the message window - and write to debug file.
				)
Declare Sub DEBUGNote(
				ByVal sMessage As String		'Message to show in messagebox - and write to debug file.
				)

'Note this function is automatically called from DEBUGPrint() and DEBUGNote()
Declare Sub DEBUGWriteToFile(
					ByVal sMessage As String	'Message to write to debug file.
					)

Declare Sub DEBUGAddDateToDebugLines(
					ByVal bAddToMessageWindow As Logical, 
					ByVal bAddToFile As Logical, 
					ByVal bAddSeparatorToIsoDate As Logical, 
					ByVal sIsoDateSeparator As String
					)
					
Declare Function createDebugDate(ByVal bAddDate As Logical) As String





'#######################################################################################################################
'#                                                                                                                     #
'#                                                    PERSONAL.DEF                                                     #
'#                                                                                                                     #
'#######################################################################################################################

'Goal to simplify addition of Buttons to the ribbon, but not including functionality that exists within the ribbon, but
'  may not be completely desired.
'
'E.G.
'Include "FULL_Ribbon.def"
'Call RIBBON_AddTab("My Tab", "M")
'Call RIBBON_AddGroup("My Tab", "My group")
'Call RIBBON_AddButton("My tab", "My group","My Button", "M", "C:\mybutton.png" ,"This is a button","subButton1")

'Add tab
Declare Sub RIBBON_AddTab(ByVal sTabName as string, ByVal sKeyTip as string)

'Add group
Declare Sub RIBBON_AddGroup(ByVal sTabName as string, ByVal sGroupName as string)

'Add big button
Declare Sub RIBBON_AddButton(ByVal sTabName as string, ByVal sGroupName as string, ByVal sButtonName as string,
	ByVal sKeyTip as string, ByVal sIconPath as string, ByVal sDescription as string, ByVal sSubName as String)

'Add a split button
Declare Sub RIBBON_AddSplitButton(ByVal sTabName as string, ByVal sGroupName as string, ByVal sSplitButtonName as string,
	ByVal sKeyTip as string, ByVal sIconPath as string, ByVal sDescription as string, ByVal sSubName as String)

'Add a group to a split button
Declare Sub RIBBON_AddSplitGroup(ByVal sTabName as string, ByVal sGroupName as string, ByVal sSplitButtonName as String,
	ByVal sSplitGroupName as string, ByVal sKeyTip as string, ByVal sIconPath as string, ByVal sDescription as string, ByVal sSubName as String)

'Add a button to a group of a split button 	
Declare Sub RIBBON_AddSplitControl(ByVal sTabName as string, ByVal sGroupName as string, ByVal sSplitButtonName as String,
	ByVal sSplitGroupName as string, ByVal sButtonName as string, ByVal sKeyTip as string, ByVal sIconPath as string,
	ByVal sDescription as string, ByVal sSubName as String)

'General replace function created by Hayden Fisher: https://groups.google.com/forum/#!topic/mapinfo-l/tqxyJzLjZ7A
Declare Function Replace(ByVal _full_string As String, ByVal _remove_string As String, ByVal _replacement_string As String) As String

'sSplit() - similar to VBA split function, however Arrays can only be passed ByRef in MapBasic (cannot be returned from Function)
Declare Sub RIBBON_sSplit(ByVal someString as string, resultArray() as String, ByVal delimeter as string)

'sJoin() - similar to VBA join function
Declare Function RIBBON_sJoin(someArray() as string, byval delimeter as string) as string

'Simple button additions (creates tabs, groups and buttons for the user)
Declare Sub RIBBON_AddSimpleButton(ByVal sTabName as string, ByVal sGroupName as string, ByVal sButtonName as string,	 ByVal sKeyTip as string, ByVal sIconPath as string, ByVal sDescription as string, ByVal sSubName as String)